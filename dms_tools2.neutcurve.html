
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>neutcurve &#8212; dms_tools2 2.4.6 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="pacbio" href="dms_tools2.pacbio.html" />
    <link rel="prev" title="minimap2" href="dms_tools2.minimap2.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <span class="target" id="module-dms_tools2.neutcurve"></span><div class="section" id="neutcurve">
<h1>neutcurve<a class="headerlink" href="#neutcurve" title="Permalink to this headline">¶</a></h1>
<p>Module for fitting neutralization curves.</p>
<dl class="function">
<dt id="dms_tools2.neutcurve.fit_fourParamLogistics">
<code class="descclassname">dms_tools2.neutcurve.</code><code class="descname">fit_fourParamLogistics</code><span class="sig-paren">(</span><em>neutdata</em>, <em>plotfile</em>, <em>fixbottom=False</em>, <em>fixtop=1</em>, <em>xlabel='antibody concentration'</em>, <em>ylabel='fraction surviving'</em>, <em>maxcol=3</em>, <em>ic50_in_name=True</em>, <em>nfitpoints=100</em>, <em>cextend=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dms_tools2/neutcurve.html#fit_fourParamLogistics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dms_tools2.neutcurve.fit_fourParamLogistics" title="Permalink to this definition">¶</a></dt>
<dd><p>Fits and plots set of neutralization curves.</p>
<p>Fits a set of 4-parameter logistic neutralization curves
as defined by <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic" title="dms_tools2.neutcurve.fourParamLogistic"><code class="xref py py-class docutils literal notranslate"><span class="pre">fourParamLogistic</span></code></a>. Then makes a faceted
plot showing all these curves.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt><cite>neutdata</cite> (panda DataFrame)</dt>
<dd>Data to fit. There should be a column
named <cite>concentration</cite> and every other column
should be named by the sample and give the 
fraction surviving at each concentration.</dd>
<dt><cite>plotfile</cite> (str)</dt>
<dd>Name of created plot file showing the fitted
curves (e.g., PDF or PNG)</dd>
<dt><cite>fixbottom</cite></dt>
<dd>Same meaning as for <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic" title="dms_tools2.neutcurve.fourParamLogistic"><code class="xref py py-class docutils literal notranslate"><span class="pre">fourParamLogistic</span></code></a></dd>
<dt><cite>fixtop</cite></dt>
<dd>Same meaning as for <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic" title="dms_tools2.neutcurve.fourParamLogistic"><code class="xref py py-class docutils literal notranslate"><span class="pre">fourParamLogistic</span></code></a></dd>
<dt><cite>xlabel</cite> (str)</dt>
<dd>x-label on plot</dd>
<dt><cite>ylabel</cite> (str)</dt>
<dd>y-label on plot</dd>
<dt><cite>maxcol</cite> (int)</dt>
<dd>Max number of columns in faceted plot</dd>
<dt><cite>ic50_in_name</cite> (bool)</dt>
<dd>Same meaning as for <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic.plot" title="dms_tools2.neutcurve.fourParamLogistic.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fourParamLogistic.plot()</span></code></a></dd>
<dt><cite>nfitpoints</cite> (int)</dt>
<dd>Same meaning as for <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic.plot" title="dms_tools2.neutcurve.fourParamLogistic.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fourParamLogistic.plot()</span></code></a></dd>
<dt><cite>cextend</cite> (float)</dt>
<dd>Same meaning as for <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic.plot" title="dms_tools2.neutcurve.fourParamLogistic.plot"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fourParamLogistic.plot()</span></code></a></dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>A dictionary keyed by each sample in <cite>neutdata</cite>,
and with the values being the <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic" title="dms_tools2.neutcurve.fourParamLogistic"><code class="xref py py-class docutils literal notranslate"><span class="pre">fourParamLogistic</span></code></a>
fitted object for that sample. You can use these
objects to get detailed information about the fits.</dd>
</dl>
<p>Here is an example of plotting three curves in a 
single row (we keep the default <cite>maxcol=3</cite>):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neutdata</span> <span class="o">=</span> <span class="n">pandas</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">StringIO</span><span class="p">(</span>
<span class="gp">... </span><span class="sd">&#39;&#39;&#39;concentration K280A-1 K280A-2 wildtype</span>
<span class="gp">... </span><span class="sd">          0.0002  1.2049  1.2140  1.0549</span>
<span class="gp">... </span><span class="sd">          0.0005  1.0026  1.0107  0.9337</span>
<span class="gp">... </span><span class="sd">          0.0011  1.1422  1.1173  0.8025</span>
<span class="gp">... </span><span class="sd">          0.0026  0.9066  0.8368  0.4267</span>
<span class="gp">... </span><span class="sd">          0.0061  0.6952  0.8242  0.1769</span>
<span class="gp">... </span><span class="sd">          0.0142  0.3907  0.4503  0.0234</span>
<span class="gp">... </span><span class="sd">          0.0331  0.0714  0.0660  0.0001</span>
<span class="gp">... </span><span class="sd">          0.0771 -0.0119 -0.0157 -0.0146</span>
<span class="gp">... </span><span class="sd">          0.1800 -0.0311 -0.0333 -0.0377</span>
<span class="gp">... </span><span class="sd">          0.4199 -0.0344 -0.0320 -0.0367</span>
<span class="gp">... </span><span class="sd">          0.9797 -0.0365 -0.0382 -0.0346</span>
<span class="gp">... </span><span class="sd">          2.2861 -0.0291 -0.0345 -0.0362&#39;&#39;&#39;</span><span class="p">),</span>
<span class="gp">... </span>        <span class="n">delim_whitespace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">index_col</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plotfile</span> <span class="o">=</span> <span class="s1">&#39;_fit_fourParamLogistics_neutplot.png&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neutcurves</span> <span class="o">=</span> <span class="n">fit_fourParamLogistics</span><span class="p">(</span><span class="n">neutdata</span><span class="p">,</span> <span class="n">plotfile</span><span class="p">)</span>
</pre></div>
</div>
<p>The plot looks like this:</p>
<a class="reference internal image-reference" href="_images/_fit_fourParamLogistics_neutplot.png"><img alt="_images/_fit_fourParamLogistics_neutplot.png" class="align-center" src="_images/_fit_fourParamLogistics_neutplot.png" style="width: 6in;" /></a>
<p>We can access the IC50 values and other fitted parameters via
the returned <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic" title="dms_tools2.neutcurve.fourParamLogistic"><code class="xref py py-class docutils literal notranslate"><span class="pre">fourParamLogistic</span></code></a> objects. For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="s1">&#39;IC50 for K280A-1 is </span><span class="si">{0:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
<span class="gp">... </span>        <span class="n">neutcurves</span><span class="p">[</span><span class="s1">&#39;K280A-1&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">ic50</span><span class="p">()))</span>
<span class="go">IC50 for K280A-1 is 0.0105</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="dms_tools2.neutcurve.fourParamLogistic">
<em class="property">class </em><code class="descclassname">dms_tools2.neutcurve.</code><code class="descname">fourParamLogistic</code><span class="sig-paren">(</span><em>cs</em>, <em>fs</em>, <em>fixbottom=False</em>, <em>fixtop=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dms_tools2/neutcurve.html#fourParamLogistic"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dms_tools2.neutcurve.fourParamLogistic" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>A fitted 4-parameter logistic neutralization curve.</p>
<p>Fits <span class="math notranslate nohighlight">\(f(c) = b + \frac{t - b}{1 + (c/m)^s}\)</span>
where <span class="math notranslate nohighlight">\(f(c)\)</span> is the fraction surviving at
concentration <span class="math notranslate nohighlight">\(c\)</span>, <span class="math notranslate nohighlight">\(m\)</span> is the midpoint
of the neutralization curve, <span class="math notranslate nohighlight">\(t\)</span> is the top
value (e.g., 1), <span class="math notranslate nohighlight">\(b\)</span> is the bottom value (e.g., 0),
and <span class="math notranslate nohighlight">\(s\)</span> is the slope of the curve.</p>
<p>This documentation is written for the case when 
<span class="math notranslate nohighlight">\(f(c)\)</span> is the fraction <strong>surviving</strong>, meaning that
<span class="math notranslate nohighlight">\(f(c)\)</span> gets smaller as <span class="math notranslate nohighlight">\(c\)</span> gets larger.
This should lead you to fit <span class="math notranslate nohighlight">\(s &gt; 0\)</span>.
If you instead use <span class="math notranslate nohighlight">\(f(c)\)</span> as the fraction neutralized,
you will fit <span class="math notranslate nohighlight">\(s &lt; 1\)</span>. In this case, the interpretation
of <cite>top</cite> and <cite>bottom</cite> will be reversed. However, this class
has <strong>not</strong> been extensively tested in that scenario, and
so may not work completely correctly if you have
<span class="math notranslate nohighlight">\(f(c)\)</span> represent the fraction neutralized.</p>
<dl class="docutils">
<dt>To initialize and fit an object, provide the following:</dt>
<dd><dl class="first last docutils">
<dt><cite>cs</cite> (array-like)</dt>
<dd>Concentrations for which we have measurements
to fit.</dd>
<dt><cite>fs</cite> (array-like)</dt>
<dd>Same length as <cite>cs</cite>, with <cite>fs[i]</cite> giving
fraction surviving at <cite>cs[i]</cite>.</dd>
<dt><cite>fixbottom</cite> (bool)</dt>
<dd>If <cite>False</cite>, we fit the bottom value of the
curve. If you instead want to fix it,
provide the number to fix it to (typically 0).
Fix this number if you think that the neutralization
goes to completion at high enough antibody.
concentration. For some viruses (such as HIV),
the neutralization never goes to completion as 
there are some resistant viruses (such as due
to glycan heterogeneity) – if that is the case,
you want to fit the bottom rather than fix it to 0.</dd>
<dt><cite>fixtop</cite> (<cite>False</cite> or a float)</dt>
<dd>If <cite>False</cite>, we fit the top value of the
curve. If you instead want to fix it,
provide the number to fix it to (typically 1).
Usually you do <strong>not</strong> want to fit this value,
as the fraction surviving should always be one
at sufficiently low antibody concentration.</dd>
</dl>
</dd>
<dt>After initialization, has the following attributes:</dt>
<dd><dl class="first last docutils">
<dt><cite>cs</cite> (numpy array)</dt>
<dd>Array of the concentration measurements we have
fitted, sorted from lowest to highest.</dd>
<dt><cite>fs</cite> (numpy array)</dt>
<dd>Array of the fraction surviving measurements
corresponding to the entries in <cite>cs</cite>.</dd>
<dt><cite>midpoint</cite> (float)</dt>
<dd>Midpoint of curve, <span class="math notranslate nohighlight">\(m\)</span> in equation above.
Note that the midpoint may <strong>not</strong> be the same
as the <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic.ic50" title="dms_tools2.neutcurve.fourParamLogistic.ic50"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ic50()</span></code></a></dd>
<dt><cite>slope</cite> (float)</dt>
<dd>Hill slope of curve, <span class="math notranslate nohighlight">\(s\)</span> in equation above.</dd>
<dt><cite>bottom</cite> (float)</dt>
<dd>Bottom of curve (value as <span class="math notranslate nohighlight">\(c\)</span> gets large),
<span class="math notranslate nohighlight">\(b\)</span> in equation above.</dd>
<dt><cite>top</cite> (float)</dt>
<dd>Top of curve (value as <span class="math notranslate nohighlight">\(c\)</span> get small),
<span class="math notranslate nohighlight">\(t\)</span> in equation above.</dd>
</dl>
</dd>
</dl>
<p>Use the <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic.ic50" title="dms_tools2.neutcurve.fourParamLogistic.ic50"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ic50()</span></code></a> function to get the fitted IC50.</p>
<p>As an example, we first simulate some data with known
parameter values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">m</span> <span class="o">=</span> <span class="mf">0.03</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="mf">1.9</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="mf">1.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cs</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.002</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">9</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs</span> <span class="o">=</span> <span class="p">[</span><span class="n">fourParamLogistic</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cs</span><span class="p">]</span>
</pre></div>
</div>
<p>Now we fit to these data, and then confirm that the
fitted values are close to the ones used for the
simulation:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neut</span> <span class="o">=</span> <span class="n">fourParamLogistic</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">fs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">neut</span><span class="o">.</span><span class="n">midpoint</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">neut</span><span class="o">.</span><span class="n">slope</span><span class="p">,</span> <span class="n">s</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">neut</span><span class="o">.</span><span class="n">top</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">neut</span><span class="o">.</span><span class="n">bottom</span><span class="p">,</span> <span class="n">b</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Note how since we fit the curve to simulated data where
the bottom was 0.1 rather than 0, the midpoint and IC50
are different. Specifically, the IC50 is larger than the
midpoint, as you have to go past the midpoint to get
down to value of 0.5 fraction surviving.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neut</span><span class="o">.</span><span class="n">ic50</span><span class="p">()</span> <span class="o">&gt;</span> <span class="n">neut</span><span class="o">.</span><span class="n">midpoint</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">neut</span><span class="o">.</span><span class="n">ic50</span><span class="p">(),</span> <span class="mf">0.0337385586</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">neut</span><span class="o">.</span><span class="n">fracsurvive</span><span class="p">(</span><span class="n">neut</span><span class="o">.</span><span class="n">ic50</span><span class="p">()))</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neut</span><span class="o">.</span><span class="n">fracsurvive</span><span class="p">(</span><span class="n">neut</span><span class="o">.</span><span class="n">midpoint</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mf">0.5</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Here is a plot of the curve and data points:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">neut</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="s1">&#39;_fourParamLogistic_neutplot.png&#39;</span><span class="p">,</span> <span class="s1">&#39;example&#39;</span><span class="p">)</span>
</pre></div>
</div>
<a class="reference internal image-reference" href="_images/_fourParamLogistic_neutplot.png"><img alt="_images/_fourParamLogistic_neutplot.png" class="align-center" src="_images/_fourParamLogistic_neutplot.png" style="width: 2.4in;" /></a>
<p>Now here is an example where we constrain both the top
and the bottom (to 1 and 0, respectively) and fit
the curve. Now the midpoint and IC50 are the same:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">b2</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t2</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs2</span> <span class="o">=</span> <span class="p">[</span><span class="n">fourParamLogistic</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cs</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neut2</span> <span class="o">=</span> <span class="n">fourParamLogistic</span><span class="p">(</span><span class="n">cs</span><span class="p">,</span> <span class="n">fs2</span><span class="p">,</span> <span class="n">fixbottom</span><span class="o">=</span><span class="n">b2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">neut2</span><span class="o">.</span><span class="n">midpoint</span><span class="p">,</span> <span class="n">m</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">scipy</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">neut2</span><span class="o">.</span><span class="n">ic50</span><span class="p">(),</span> <span class="n">m</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
<p>Now let’s fit to concentrations that are all <strong>less</strong>
than the midpoint, so that we never get anywhere
close to complete neutralization. In this case,
the estimated IC50 is unreliable, and so will be
returned as <cite>None</cite>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs3</span> <span class="o">=</span> <span class="p">[</span><span class="mf">1e-5</span> <span class="o">*</span> <span class="mi">2</span><span class="o">**</span><span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">(</span><span class="n">cs3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fs3</span> <span class="o">=</span> <span class="p">[</span><span class="n">fourParamLogistic</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">m</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">b2</span><span class="p">,</span> <span class="n">t2</span><span class="p">)</span> <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">cs3</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neut3</span> <span class="o">=</span> <span class="n">fourParamLogistic</span><span class="p">(</span><span class="n">cs3</span><span class="p">,</span> <span class="n">fs3</span><span class="p">,</span> <span class="n">fixbottom</span><span class="o">=</span><span class="n">b2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neut3</span><span class="o">.</span><span class="n">ic50</span><span class="p">()</span> <span class="ow">is</span> <span class="kc">None</span>
<span class="go">True</span>
</pre></div>
</div>
<p>However, we can still see a limit on the IC50
using the <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic.ic50_str" title="dms_tools2.neutcurve.fourParamLogistic.ic50_str"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ic50_str()</span></code></a> method. As seen below,
this limit indicates that the IC50 exceeds the
largest value in the concentrations used to fit
the curve:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cs3</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">0.00064</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">neut3</span><span class="o">.</span><span class="n">ic50_str</span><span class="p">()</span>
<span class="go">&#39;$&gt;0.00064$&#39;</span>
</pre></div>
</div>
<dl class="staticmethod">
<dt id="dms_tools2.neutcurve.fourParamLogistic.evaluate">
<em class="property">static </em><code class="descname">evaluate</code><span class="sig-paren">(</span><em>c</em>, <em>m</em>, <em>s</em>, <em>b</em>, <em>t</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dms_tools2/neutcurve.html#fourParamLogistic.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dms_tools2.neutcurve.fourParamLogistic.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <span class="math notranslate nohighlight">\(f(c) = b + \frac{t - b}{1 + (c/m)^s}\)</span>.</p>
</dd></dl>

<dl class="method">
<dt id="dms_tools2.neutcurve.fourParamLogistic.fracsurvive">
<code class="descname">fracsurvive</code><span class="sig-paren">(</span><em>c</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dms_tools2/neutcurve.html#fourParamLogistic.fracsurvive"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dms_tools2.neutcurve.fourParamLogistic.fracsurvive" title="Permalink to this definition">¶</a></dt>
<dd><p>Fraction surviving at <cite>c</cite> for fitted parameters.</p>
</dd></dl>

<dl class="method">
<dt id="dms_tools2.neutcurve.fourParamLogistic.ic50">
<code class="descname">ic50</code><span class="sig-paren">(</span><em>extrapolate=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dms_tools2/neutcurve.html#fourParamLogistic.ic50"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dms_tools2.neutcurve.fourParamLogistic.ic50" title="Permalink to this definition">¶</a></dt>
<dd><p>IC50 value.</p>
<p>Concentration where <cite>fracsurvive</cite> is 0.5. Equals
<cite>midpoint</cite> if and only if <cite>top = 1</cite> and <cite>bottom = 0</cite>.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt><cite>extrapolate</cite> (bool)</dt>
<dd>Do we extrapolate IC50 outside of range
of data we fit? (Generally a bad idea.)</dd>
</dl>
</dd>
<dt>Returns:</dt>
<dd>A number giving the IC50 if the fitted value
is in the range of concentrations used
to fit the curve. Otherwise returns <cite>None</cite>
unless <cite>extrapolate</cite> is <cite>True</cite>. Will still
return <cite>None</cite> even if <cite>extrapolate</cite> is <cite>True</cite>
if the fit parameters are such that the
extrapolated curve never reaches 0.5.</dd>
</dl>
<p>Calculated from:
<span class="math notranslate nohighlight">\(0.5 = b + \frac{t - b}{1 + (ic50/m)^s}\)</span>,
which solves to 
<span class="math notranslate nohighlight">\(ic50 = m \times \left(\frac{t - 0.5}{0.5 - b}\right)^{1/s}\)</span></p>
</dd></dl>

<dl class="method">
<dt id="dms_tools2.neutcurve.fourParamLogistic.ic50_str">
<code class="descname">ic50_str</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/dms_tools2/neutcurve.html#fourParamLogistic.ic50_str"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dms_tools2.neutcurve.fourParamLogistic.ic50_str" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns string containing IC50.</p>
<p>Unlike <a class="reference internal" href="#dms_tools2.neutcurve.fourParamLogistic.ic50" title="dms_tools2.neutcurve.fourParamLogistic.ic50"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ic50()</span></code></a>, it returns a string.
This is useful because the string will indicate
if the extrapolated IC50 is outside the 
range of fitted data, such as by being: <cite>&gt; 0.5</cite>.</p>
</dd></dl>

<dl class="method">
<dt id="dms_tools2.neutcurve.fourParamLogistic.plot">
<code class="descname">plot</code><span class="sig-paren">(</span><em>plotfile</em>, <em>samplename</em>, <em>ic50_in_name=True</em>, <em>xlabel='antibody concentration'</em>, <em>ylabel='fraction surviving'</em>, <em>nfitpoints=100</em>, <em>cextend=2</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/dms_tools2/neutcurve.html#fourParamLogistic.plot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#dms_tools2.neutcurve.fourParamLogistic.plot" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots neutralization points and fitted curve.</p>
<dl class="docutils">
<dt>Args:</dt>
<dd><dl class="first last docutils">
<dt><cite>plotfile</cite> (str)</dt>
<dd>Name of plot to create (e.g., PDF or PNG).</dd>
<dt><cite>samplename</cite> (str)</dt>
<dd>Sample name (put at top of plot)</dd>
<dt><cite>ic50_in_name</cite> (bool)</dt>
<dd>Include IC50 at top of plot with sample name?</dd>
<dt><cite>xlabel</cite> (str)</dt>
<dd>x-axis label</dd>
<dt><cite>ylabel</cite> (str)</dt>
<dd>y-axis label</dd>
<dt><cite>nfitpoints</cite> (int)</dt>
<dd>Number of points used to draw fit line.</dd>
<dt><cite>cextend</cite> (float)</dt>
<dd>Concentrations extend this much fold
below / above the min / max values used
for fitting.</dd>
</dl>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="index.html">
    <img class="logo" src="_static/BloomLogo.jpg" alt="Logo"/>
    
    <h1 class="logo logo-name">dms_tools2</h1>
    
  </a>
</p>



<p class="blurb">Tools for analyzing deep mutational scanning data.</p>




<p>
<iframe src="https://ghbtns.com/github-btn.html?user=jbloomlab&repo=dms_tools2&type=watch&count=true&size=large&v=2"
  allowtransparency="true" frameborder="0" scrolling="0" width="200px" height="35px"></iframe>
</p>





    

<p>
<a class="badge" href="https://travis-ci.org/jbloomlab/dms_tools2">
    <img
        alt="https://secure.travis-ci.org/jbloomlab/dms_tools2.svg?branch=master"
        src="https://secure.travis-ci.org/jbloomlab/dms_tools2.svg?branch=master"
    />
</a>
</p>


<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="examples.html">Examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="bcsubamp.html">Barcoded-subamplicon sequencing</a></li>
<li class="toctree-l1"><a class="reference internal" href="prefs.html">Amino-acid preferences</a></li>
<li class="toctree-l1"><a class="reference internal" href="diffsel.html">Differential selection</a></li>
<li class="toctree-l1"><a class="reference internal" href="fracsurvive.html">Fraction surviving</a></li>
<li class="toctree-l1"><a class="reference internal" href="programs.html">Executable programs</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="api.html">Python API</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="dms_tools2.html">dms_tools2 package</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="citations.html">Citations</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
  <li><a href="api.html">Python API</a><ul>
  <li><a href="dms_tools2.html">dms_tools2 package</a><ul>
      <li>Previous: <a href="dms_tools2.minimap2.html" title="previous chapter">minimap2</a></li>
      <li>Next: <a href="dms_tools2.pacbio.html" title="next chapter">pacbio</a></li>
  </ul></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2017--2019, the Bloom lab.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.8.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.12</a>
      
      |
      <a href="_sources/dms_tools2.neutcurve.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/jbloomlab/dms_tools2" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>